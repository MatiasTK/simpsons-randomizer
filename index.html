<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Encuentra capítulos aleatorios de Los Simpsons de diferentes fuentes"
    />
    <meta
      name="keywords"
      content="simpsons, episodios, aleatorio, capítulos, streaming"
    />
    <meta name="author" content="MatiasTK" />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Simpsons Randomizer" />
    <meta
      property="og:description"
      content="Mira capítulos aleatorios de Los Simpsons"
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Simpsons Randomizer" />
    <meta
      name="twitter:description"
      content="Mira capítulos aleatorios de Los Simpsons"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <title>Simpsons Randomizer - Encuentra episodios aleatorios</title>

    <style>
      .btn-secondary {
        background-color: #343a40;
        border-color: #343a40;
      }
      .btn-stremio {
        background-color: #7b5bf5;
        border-color: #7b5bf5;
      }
      .btn-stremio:hover {
        background-color: #6442e6;
        border-color: #6442e6;
      }
      .btn-stremio:active {
        background-color: #5533b3 !important;
        border-color: #5533b3 !important;
      }
      .form-check-input {
        width: 1.25rem !important;
        height: 1.25rem !important;
      }
      .episode-card {
        transition: transform 0.2s ease-in-out;
      }
      .episode-card:hover {
        transform: translateY(-2px);
      }
      .btn-secondary.disabled {
        opacity: 0.5;
        cursor: not-allowed;
        pointer-events: none;
      }
      /* Layout constraints so main doesn't push controls off-screen */
      .app-main {
        max-height: 70dvh;
        overflow: hidden;
      }
      /* Ensure episode image crops rather than stretching */
      #episode-image {
        height: clamp(120px, 24vh, 200px);
        object-fit: cover;
      }
      @media (max-width: 576px) {
        #episode-image {
          height: clamp(60px, 12vh, 150px);
          object-fit: contain; /* ensure full image is visible */
          object-position: center; /* center inside the box */
          background-color: #000; /* letterbox background for non-matching aspect ratios */
        }
      }
    </style>
  </head>

  <body class="bg-dark text-white d-flex flex-column">
    <div
      class="d-flex align-items-center justify-content-start flex-column pb-2"
      style="min-height: 100dvh"
    >
      <header class="py-3">
        <h1 class="display-4 text-center mb-0">Simpsons Randomizer</h1>
        <p class="text-center text-white-50 mt-2 mb-0 fs-6">
          Encuentra episodios aleatorios de Los Simpsons
        </p>
      </header>

      <main
        class="container-fluid d-flex align-items-center justify-content-center flex-grow-1 app-main"
      >
        <section
          id="episodioEncontrado"
          class="d-flex justify-content-center"
          aria-live="polite"
        >
          <!-- Loading Spinner -->
          <div
            class="spinner-border visually-hidden"
            role="status"
            style="width: 5rem; height: 5rem"
            id="spinner"
            aria-label="Cargando episodio..."
          >
            <span class="visually-hidden">Cargando...</span>
          </div>

          <!-- Episode Card -->
          <article
            class="card visually-hidden-focusable episode-card d-flex flex-column"
            id="card"
            data-bs-theme="dark"
            aria-labelledby="episode-title"
            style="width: 20rem"
          >
            <img
              class="card-img-top"
              alt="Imagen del capítulo"
              id="episode-image"
            />
            <div class="card-body d-flex flex-column">
              <div
                class="d-flex justify-content-between align-items-center mb-2"
              >
                <span class="badge bg-primary">
                  <span>Temporada: </span>
                  <span id="episode-season"></span>
                </span>
                <span class="badge bg-primary">
                  <span>Episodio: </span>
                  <span id="episode-number"></span>
                </span>
              </div>
              <h2 class="card-title h5 text-truncate" id="episode-title"></h2>
              <div class="episode-description-container mb-4">
                <p
                  class="card-text overflow-hidden small text-muted mb-0"
                  id="episode-description"
                  style="
                    display: -webkit-box;
                    -webkit-line-clamp: 3;
                    line-clamp: 3;
                    -webkit-box-orient: vertical;
                    text-overflow: ellipsis;
                  "
                ></p>
                <button
                  class="btn btn-link btn-sm text-primary p-0 mt-1 visually-hidden text-decoration-none"
                  id="show-more-btn"
                  type="button"
                  aria-label="Mostrar más texto de la descripción"
                >
                  Mostrar más
                </button>
              </div>
              <div class="d-flex flex-column gap-2 mt-auto">
                <div class="d-flex align-items-center gap-2">
                  <a
                    class="btn btn-primary w-100 fw-semibold"
                    rel="noopener noreferrer"
                    target="_blank"
                    id="episodio-link"
                    aria-describedby="episode-title"
                  >
                    Ver episodio
                  </a>
                  <button
                    class="btn btn-secondary text-nowrap"
                    id="copiar"
                    type="button"
                    aria-label="Copiar enlace del episodio"
                  >
                    Copiar Link
                  </button>
                </div>
                <a
                  class="btn btn-stremio text-nowrap fw-semibold text-white"
                  href="#"
                  target="_blank"
                  rel="noopener noreferrer"
                  id="stremio-link"
                  aria-label="Ver en Stremio"
                >
                  Ver en Stremio
                </a>
              </div>
            </div>
          </article>
        </section>
      </main>

      <section class="controls-section mb-3 mt-auto">
        <div class="mt-4">
          <div
            class="d-flex align-items-center gap-2 justify-content-center flex-column"
          >
            <div class="d-flex flex-column gap-2">
              <form
                class="d-flex gap-2 align-items-end"
                role="search"
                aria-label="Configuración de búsqueda"
                data-bs-theme="dark"
              >
                <fieldset class="border-0 p-0 m-0">
                  <legend class="visually-hidden">
                    Configuración de temporadas
                  </legend>
                  <div class="form-group">
                    <label class="small ps-1" for="temporadaInput"
                      >Hasta temporada:</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="temporadaInput"
                      name="temporada"
                      min="1"
                      max="34"
                      placeholder="10"
                      value="10"
                      aria-describedby="temporada-help"
                    />
                    <div id="temporada-help" class="form-text visually-hidden">
                      Selecciona hasta qué temporada quieres buscar episodios
                      (1-34)
                    </div>
                  </div>
                </fieldset>

                <fieldset class="border-0 p-0 m-0">
                  <legend class="visually-hidden">Selección de fuente</legend>
                  <div class="dropdown">
                    <button
                      class="btn btn-secondary bg-secondary-emphasis dropdown-toggle"
                      type="button"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                      aria-label="Seleccionar fuente de episodios"
                    >
                      Fuentes
                    </button>
                    <ul class="dropdown-menu" data-bs-theme="dark" role="menu">
                      <li role="none">
                        <a
                          class="dropdown-item source"
                          href="#"
                          role="menuitem"
                          tabindex="0"
                          >simpsonslatino.online</a
                        >
                      </li>
                      <li role="none">
                        <a
                          class="dropdown-item source"
                          href="#"
                          role="menuitem"
                          tabindex="0"
                          >simpsonizados.me</a
                        >
                      </li>
                      <li role="none">
                        <a
                          class="dropdown-item source"
                          href="#"
                          role="menuitem"
                          tabindex="0"
                          >simpsonhd.com</a
                        >
                      </li>
                      <li role="none">
                        <a
                          class="dropdown-item source"
                          href="#"
                          role="menuitem"
                          tabindex="0"
                          >pelisplus.to</a
                        >
                      </li>
                    </ul>
                  </div>
                </fieldset>
              </form>

              <button
                type="button"
                class="btn btn-primary fw-semibold"
                id="encontrar"
                aria-label="Buscar episodio aleatorio"
              >
                Encuentra un episodio
              </button>

              <fieldset class="border-0 p-0 m-0">
                <legend class="visually-hidden">
                  Opciones de visualización
                </legend>
                <div
                  class="d-flex align-items-center gap-2 form-check mt-2 ms-2"
                >
                  <input
                    class="form-check-input my-auto"
                    type="checkbox"
                    id="nueva-pestana"
                    name="nueva-pestana"
                  />
                  <label class="form-check-label" for="nueva-pestana">
                    Abrir en nueva pestaña
                  </label>
                </div>
              </fieldset>
            </div>
          </div>
        </div>
      </section>
    </div>

    <footer class="text-center position-relative mb-2">
      <hr class="text-white-50 w-50 mx-auto" />
      <!-- Toast Notification -->
      <div
        class="toast align-items-center text-bg-success border-0 ms-auto me-auto position-absolute start-50 translate-middle-x"
        style="top: 0%"
        id="fuenteToast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-delay="2500"
      >
        <div class="d-flex">
          <div class="toast-body"></div>
          <button
            type="button"
            class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Cerrar notificación"
          ></button>
        </div>
      </div>

      <p class="mb-2 ms-2 text-center">
        Hecho con <span class="text-danger" aria-label="amor">♥️</span> por
        <a
          href="https://github.com/MatiasTK"
          class="text-decoration-none text-danger"
          target="_blank"
          rel="noopener"
          aria-label="Visitar perfil de GitHub de MatiasTK"
        >
          MatiasTK
        </a>
      </p>
    </footer>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script type="module" src="src/js/main.js"></script>
  </body>
</html>
